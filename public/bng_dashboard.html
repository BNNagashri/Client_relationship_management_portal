<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-6">
        <h2 class="text-3xl font-bold mb-6 text-center">Client Dashboard</h2>
        <div id="clientGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Client cards will be inserted here by JavaScript -->
        </div>
    </div>

    <script>
        async function fetchClientData() {
            try {
                const response = await fetch('/api/clients');
                const clients = await response.json();
                
                const clientGrid = document.getElementById('clientGrid');
                clients.forEach(client => {
                    const clientCard = document.createElement('div');
                    clientCard.className = 'bg-white p-4 rounded shadow-lg';

                    clientCard.innerHTML = `
                        <h3 class="text-xl font-bold">${client.name}</h3>
                        <p><strong>Company:</strong> ${client.companyName}</p>
                        <p><strong>Email:</strong> ${client.email}</p>
                        <p><strong>Phone:</strong> ${client.phoneNumber}</p>
                        <p><strong>Domain:</strong> ${client.domain}</p>
                        <p><strong>Notes:</strong> ${client.notes}</p>

                         <p><strong>Strategy Partner:</strong> ${client.strategyPartner || 'N/A'}</p>
                         
                        <div class="mt-4">
                       
                            ${client.visitingCardImages.map(url => `
                                <img src="${url}" alt="Visiting Card Image" class="w-full h-auto rounded-md mb-2"/>
                            `).join('')}
                        </div>
                          <button onclick="deleteClient('${client._id}')" class="mt-4 px-4 py-2 bg-red-500 text-white rounded">Delete</button>
                    `;

                    clientGrid.appendChild(clientCard);
                });
            } catch (error) {
                console.error('Error fetching client data:', error);
            }
        }
        async function deleteClient(clientId) {
            if (confirm('Are you sure you want to delete this client?')) {
                try {
                    const response = await fetch(`/api/clients/${clientId}`, {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        alert('Client deleted successfully.');
                        location.reload(); // Refresh the page to update the client list
                    } else {
                        console.error('Error deleting client:', response.statusText);
                        alert('Failed to delete the client.');
                    }
                } catch (error) {
                    console.error('Error deleting client:', error);
                    alert('Error deleting client.');
                }
            }
        }
        // Fetch and display client data on page load
        window.onload = fetchClientData;
    </script>
</body>
</html>
